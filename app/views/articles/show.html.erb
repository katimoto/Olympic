<div class='wrapper'>
  <div class='up1'>
    <%= form_with(url: search_articles_path, local: true, method: :get, class: "search-form") do |form| %>
      <%= form.text_field :keyword, placeholder: "タグで検索する", class: "search-input" %>
      <%= form.submit "検索", class: "search-btn" %>
    <% end %>
    <%= link_to user_path(current_user), class: "user-profile" do %>
      <% if current_user.name == "ゲストユーザー" %>
        <%= image_tag 'default.png', class: "image-profile" %>
      <% else %>
        <%= image_tag current_user.image.variant(resize: '50x50'), class:"image-profile" if current_user.image.attached?%>
      <% end %>
    <% end %>
    <%= link_to root_path, class: "help" do %>
      <i class="far fa-question-circle"></i>
    <% end %>
  </div>
  <div class='down1'>
    <div class='side_main'>
    <% @rooms = Room.all %>
    <% @rooms.each do |room| %>
      <% if room.user_id == current_user.id %>
        <%= link_to room_messages_path(room), data: {"turbolinks"=>false} do %>
          <%= image_tag room.user.image, class:"image-profile" if room.user.image.attached? %>
        <% end %>
      <% end %>
    <% end %>
    <%= link_to rooms_path do %>
      <i class="fas fa-plus"></i>
    <% end %>
    </div>
    <div class='nav_main'>
      <div class='up2'>
        <%= link_to search_articles_path do %>
          <p>記事一覧<p>
        <% end %>
      </div>
      <div class='down2'>
        <%= render "header"%>
      </div>
    </div>
    <div class='main'>
      <div class='main_menu'>
        <h1 class="head_en">Article</h1>
        <div class='aside'>
          <div class='article_like'>
            <h3>いいね数ランキング</h3>
          </div>
          <div class='ranking_like'>
          <% if @article_ranking %>
            <th>１位：</th>
            <td><%= link_to @article_ranking.first.user.name, user_path(@article_ranking.first.user) %></td>
            <th>２位：</th>
            <td><%= link_to @article_ranking.second.user.name, user_path(@article_ranking.second.user) %></td>
            <th>３位：</th>
            <td><%= link_to @article_ranking.third.user.name, user_path(@article_ranking.third.user) %></td>
          <% end %>
          </div>
        </div>
      </div>
      <div class='main_content'>
        <div class="contents row">
          <div class="content_post_show">
            <div class='post_picture_show'>
              <%= image_tag @article.image.variant(resize: '500x500'), class: 'article-image' if @article.image.attached? %>
              <span class="name">
                <a href="/users/<%= @article.user.id %>">
                  <span>投稿者:<%= @article.user.name %></span>
                </a>
              </span>
            </div>
            <div class='content_show'>
              <h3><%= @article.title %></h3>
              <p>内容：<%= @article.text %></p>
              <% @article.tags.each do |tag| %>
                <h6>#<%= tag.word %></h6>
              <%end%>
              <% if user_signed_in? && current_user.id == @article.user_id %>
              <div class="more">
                <ul class="more_list">
                  <li>
                    <%= link_to '編集', edit_article_path(@article.id), method: :get, data: {"turbolinks"=>false} %>
                  </li>
                  <li>
                    <%= link_to '削除', article_path(@article.id), method: :delete, data: {confirm: "削除しますか？"} %>
                  </li>
                </ul>
              </div>
              <% end %>
              <div class='favorites_<%= @article.id %>'>
                <%= render partial: 'favorites/favorite', locals: { article: @article } %>
              </div>
            </div>
          </div>
          <div class="container">
            <ul>
              <li class="comment-create">
                <h3 class="text-left title">レビュー</h3>
              </li>
              <li id="comments_area">
                <%= render partial: 'comments/index', locals: { comments: @comments } %>
              </li>
            </ul>
            <hr>
            <% if user_signed_in? %>
              <div class="comment-create">
                  <h3 class="text-left">レビューを投稿する</h3>
                  <%= render partial: 'comments/form', locals: { comment: @comment, article: @article } %>
              </div>
            <% end %>
            </div>
          </div>
        </div>
      </div>
      <%= link_to new_article_path, data: {"turbolinks"=>false} do %>
        <i class="fas fa-plus-circle firework"></i>
      <% end %>
    </div>
  </div>
</div>